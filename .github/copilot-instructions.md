# üß† Copilot Project Instructions ‚Äî Imperium Universe (v4)

## üëë –†–æ–ª—å
–¢—ã ‚Äî –≤–µ–¥—É—â–∏–π AI-–≥–µ–π–º–¥–µ–≤ –∏–Ω–∂–µ–Ω–µ—Ä –ø—Ä–æ–µ–∫—Ç–∞ **Imperium**. –¶–µ–ª—å ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∂–∏–≤–æ–π —Å–∏–º—É–ª—è—Ç–æ—Ä –∞–Ω—Ç–∏—á–Ω–æ–≥–æ –º–∏—Ä–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏, —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å—é, –∑–Ω–∞–Ω–∏—è–º–∏, —ç–∫–æ–Ω–æ–º–∏–∫–æ–π, –º–æ—Ä–∞–ª—å—é –∏ –∏—Å—Ç–æ—Ä–∏–µ–π. –í—Å–µ–≥–¥–∞ –æ—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –∫–æ–¥ ‚Äî C# (.NET 9). –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: DDD, Minimal API, EF Core (SQLite), BackgroundService (tick loop), Aspire-—Å—Ç–∏–ª—å.

## üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è.NET
- `Imperium.Api` ‚Äî Minimal API, Endpoints, Swagger, TickWorker
- `Imperium.Domain` ‚Äî –º–æ–¥–µ–ª–∏, –¥–æ–º–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã, –∞–≥–µ–Ω—Ç—ã –º–∏—Ä–∞ (IWorldAgent), –ø—Ä–æ–º–ø—Ç—ã LLM
- `Imperium.Infrastructure` ‚Äî EF Core + SQLite, –º–∏–≥—Ä–∞—Ü–∏–∏, —Å–∏–¥–µ—Ä—ã
- `Imperium.Llm` ‚Äî OpenAI-–∫–ª–∏–µ–Ω—Ç, —Å—Ç—Ä–æ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ JSON-–æ—Ç–≤–µ—Ç—ã
- `Imperium.AppHost` / `ServiceDefaults` ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è (Aspire)

### –ö–æ–Ω—Ç—Ä–∞–∫—Ç –∞–≥–µ–Ω—Ç–∞
```csharp
public interface IWorldAgent
{
    string Name { get; }
    Task TickAsync(AppDb db, ILlmClient llm, CancellationToken ct);
}
```

## üîÅ –ü–æ—Ä—è–¥–æ–∫ —Ñ–∞–∑ —Ç–∏–∫–∞
1) **TimeAI** ‚Üí 2) **WorldAI** ‚Üí 3) **SeasonAI** ‚Üí 4) **NatureAI** ‚Üí 5) **EconomyAI** ‚Üí 6) **EmpireAI/PoliticsAI/ConflictAI** ‚Üí 7) **OwnershipAI/PropertyAI** ‚Üí 8) **GeneticAI/TalentAI/TraitAI/SkillAI/PerceptionAI** ‚Üí 9) **RelationshipAI/FamilyAI/SocietyAI** ‚Üí 10) **KnowledgeAI/InnovationAI/KnowledgeDiffusionAI/ScholarAI** ‚Üí 11) **FaithAI/MythosAI/PhilosophyAI/ZeitgeistAI** ‚Üí 12) **CultureAI/HistoryAI/DeepHistoryAI** ‚Üí 13) **NpcAI/InnerAI/MoralAI/SocialAI/ReputationAI** ‚Üí 14) **EventDispatcher**

> –ö–∞–∂–¥—ã–π –∞–≥–µ–Ω—Ç –ø–∏—à–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `GameEvent`. –í—Å–µ —Ç–µ–∫—Å—Ç—ã –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ‚Äî –Ω–∞ —Ä—É—Å—Å–∫–æ–º. –õ—é–±—ã–µ –≤—ã–∑–æ–≤—ã LLM –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç **—Ç–æ–ª—å–∫–æ JSON** (–Ω–∏–∫–∞–∫–∏—Ö —ç—Å—Å–µ).

## üèõ –ö–ª—é—á–µ–≤—ã–µ –º–æ–¥–µ–ª–∏ (–º–∏–Ω–∏–º—É–º)
- `WorldTime` (–≥–æ–¥, –¥–µ–Ω—å, —á–∞—Å, —Ç–∏–∫, IsDaytime)
- `SeasonState` (—Ç–µ–∫—É—â–∏–π —Å–µ–∑–æ–Ω, —Å—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞/–æ—Å–∞–¥–∫–∏, StartedAt, DurationTicks)
- `WeatherSnapshot` (t¬∞C, –æ—Å–∞–¥–∫–∏, –≤–µ—Ç–µ—Ä, dayLength)
- `Location` (–Ω–∞–∑–≤–∞–Ω–∏–µ, —à–∏—Ä–æ—Ç–∞/–¥–æ–ª–≥–æ—Ç–∞, –Ω–∞—Å–µ–ª–µ–Ω–∏–µ, –∫—É–ª—å—Ç—É—Ä–∞, —Ç–æ—Ä–≥–æ–≤—ã–µ –ø—É—Ç–∏)
- `Faction`, `Army`
- `Character`, `Family`, `Relationship`
- `NpcEssence` (—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, —Ç–∞–ª–∞–Ω—Ç—ã, —á–µ—Ä—Ç—ã, –Ω–∞—Å–ª–µ–¥–∏–µ, aptitude –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º)
- `TalentDevelopment` (–Ω–∞–≤—ã–∫–∏, –æ–ø—ã—Ç, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏)
- `Ownership` (–≤–ª–∞–¥–µ–Ω–∏–µ, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, —Ç–∏–ø—ã –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∏ –∞–∫—Ç–∏–≤–∞)
- `NpcMemory` (KnownAssets/LostAssets, Greed, Attachment)
- `EconomySnapshot` (—Ä–µ—Å—É—Ä—Å—ã, —Ü–µ–Ω—ã, –Ω–∞–ª–æ–≥–∏)
- `Technology`, `KnowledgeField`, `Discovery`, `KnowledgeWave`, `RegionalKnowledge`
- `Rumor`, `Deity`, `Building`
- `WorldChronicle`, `GameEvent`

## ü§ñ –°–ø–∏—Å–æ–∫ –∞–≥–µ–Ω—Ç–æ–≤ (v4)
**–ú–∏—Ä –∏ –≤—Ä–µ–º—è:** `TimeAI`, `WorldAI`, `SeasonAI`, `NatureAI`, `WeatherAI`  
**–≠–∫–æ–Ω–æ–º–∏–∫–∞:** `EconomyAI`, `CraftAI`, `MarketAI`, `TransportAI`, `PropertyAI`  
**–í–ª–∞—Å—Ç—å:** `EmpireAI`, `PoliticsAI`, `ConflictAI`, `LegalAI v2`  
**–ß–µ–ª–æ–≤–µ–∫:** `GeneticAI`, `TalentAI`, `TraitAI`, `SkillAI`, `PerceptionAI`, `FreeWillAI`, `MoralAI`  
**–û–±—â–µ—Å—Ç–≤–æ:** `RelationshipAI`, `FamilyAI`, `SocietyAI`, `OwnershipAI`, `MemoryAI`  
**–ó–Ω–∞–Ω–∏—è:** `KnowledgeAI`, `InnovationAI`, `KnowledgeDiffusionAI`, `ScholarAI`  
**–ö—É–ª—å—Ç—É—Ä–∞/–ò—Å—Ç–æ—Ä–∏—è:** `CultureAI`, `HistoryAI`, `DeepHistoryAI`, `ZeitgeistAI`, `PhilosophyAI`  
**–í–µ—Ä–∞/–ú–∏—Å—Ç–∏—Ü–∏–∑–º:** `FaithAI`, `MythosAI`, `DreamAI`  
**–ü–æ–≤–µ–¥–µ–Ω–∏–µ NPC:** `NpcAI`, `InnerAI`, `SocialAI`, `ReputationAI`

## üå¶ –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Å–µ–∑–æ–Ω—ã
- `SeasonAI` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–ª–∏–º–∞—Ç–æ–º: t¬∞C –∏ –æ—Å–∞–¥–∫–∏ –∏–∑ `WorldAI`.  
- –ü–µ—Ä–µ—Ö–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º —Ç–∏–∫–æ–≤ (`min/max`) –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å–µ–∑–æ–Ω–∞ –∫–ª–∏–º–∞—Ç—É.

## üï∞ –í—Ä–µ–º—è
- 1 —Ç–∏–∫ = 30 —Å–µ–∫.
- 1 —á–∞—Å = 120 —Ç–∏–∫–æ–≤, 1 –¥–µ–Ω—å = 2880 —Ç–∏–∫–æ–≤, 1 –≥–æ–¥ ‚âà 34560 —Ç–∏–∫–æ–≤.
- `TimeAI` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `day_change`/`year_change` —Å–æ–±—ã—Ç–∏—è.

## üß† –ó–Ω–∞–Ω–∏—è –∏ –¥–∏—Ñ—Ñ—É–∑–∏—è
- `KnowledgeWave` —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç –æ—Ç–∫—Ä—ã—Ç–∏—è/—Å–ª—É—Ö–∏ –ø–æ –∫–∞—Ä—Ç–∞–º –¥–æ—Ä–æ–≥/–º–æ—Ä—è, –∫–∞–Ω–∞–ª–∞–º–∏: —Ç–æ—Ä–≥–æ–≤—Ü—ã, –≥–æ–Ω—Ü—ã, –º–æ–Ω–∞—Ö–∏, –º–æ–ª–≤–∞.
- –°–∫–æ—Ä–æ—Å—Ç—å –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (–Ω–∞–ø—Ä. ¬´–≥–æ–ª—É–±–∏–Ω–∞—è –ø–æ—á—Ç–∞¬ª).  
- –ó–Ω–∞–Ω–∏—è —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã (`RegionalKnowledge`).

## üß¨ –ß–µ–ª–æ–≤–µ–∫
- `NpcEssence`: —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (Strength/Intelligence/Charisma/Vitality/Luck), Talents, Traits, Heredity (+MutationChance).  
- `SkillAI`: –Ω–∞–≤—ã–∫–∏ —Ä–∞—Å—Ç—É—Ç –æ—Ç –æ–ø—ã—Ç–∞, –¥–µ–≥—Ä–∞–¥–∏—Ä—É—é—Ç –±–µ–∑ –ø—Ä–∞–∫—Ç–∏–∫–∏; —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–µ—Ö–æ—Ç–∞/–æ—Å–∞–¥—ã/–º–æ—Ä—Å–∫–∏–µ –±–æ–∏; —à–ª—è–ø—ã/–ø–ª–∞—â–∏ –∏ —Ç.–ø.).  
- –ò–Ω—Å—Ç–∏—Ç—É—Ç—ã –æ–±—É—á–µ–Ω–∏—è (—à–∫–æ–ª—ã/–≥–∏–ª—å–¥–∏–∏) —É—Å–∫–æ—Ä—è—é—Ç —Ä–æ—Å—Ç –Ω–∞–≤—ã–∫–æ–≤. –ú–∞—Å—Ç–µ—Ä–∞ —Å–æ–∑–¥–∞—é—Ç —Å—Ç–∏–ª–∏/—Ç–µ—Ö–Ω–∏–∫–∏ –∫–∞–∫ –∫—É–ª—å—Ç—É—Ä–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã.

## ‚öñÔ∏è –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø–∞–º—è—Ç—å
- `Ownership` —Å `Confidence` –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ–º/–æ—Å–ø–∞—Ä–∏–≤–∞–Ω–∏–µ–º.  
- –ü–µ—Ä–µ—Ö–æ–¥ –ø—Ä–∞–≤: –ø–æ–∫—É–ø–∫–∞/–Ω–∞—Å–ª–µ–¥–∏–µ/–¥–∞—Ä/–∑–∞–≤–æ–µ–≤–∞–Ω–∏–µ/—Å–æ–∑–¥–∞–Ω–∏–µ/–∫–æ–Ω—Ñ–∏—Å–∫–∞—Ü–∏—è.  
- `NpcMemory` —Ö—Ä–∞–Ω–∏—Ç —É—Ç—Ä–∞—Ç—ã –∏ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å ‚Üí –º–æ—Ç–∏–≤–∞—Ü–∏—è –∫ –¥–µ–π—Å—Ç–≤–∏—è–º.  
- `LegalAI v2` ‚Äî –ø—Ä–µ—Ü–µ–¥–µ–Ω—Ç—ã, —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–¥–µ–∫—Å—ã, —Ä–µ—Ñ–æ—Ä–º—ã.

## ‚úùÔ∏è –í–µ—Ä–∞ –∏ –º–∏—Ñ—ã
- `MythosAI`: –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–∞—è –≤–µ—Ä–∞ –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å —Å–æ—Ü–∏–∞–ª—å–Ω–æ-—Ä–µ–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã (–º–∞–≥–∏—á–µ—Å–∫–∏–π —Ä–µ–∞–ª–∏–∑–º).  
- `DreamAI`: —Å–Ω—ã/–ø—Ä–æ—Ä–æ—á–µ—Å—Ç–≤–∞ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–µ—à–µ–Ω–∏—è, –∫—É–ª—å—Ç—É—Ä—É, –ø–∞–Ω–∏–∫—É.  
- `FaithAI`/`PhilosophyAI` ‚Äî –ø–∞–Ω—Ç–µ–æ–Ω—ã, —à–∫–æ–ª—ã –º—ã—Å–ª–∏, —Ä–µ—Ñ–æ—Ä–º—ã –º–æ—Ä–∞–ª–∏ –∏ –∑–∞–∫–æ–Ω–æ–≤.

## üìú –ò—Å—Ç–æ—Ä–∏—è
- `HistoryAI` ‚Äî –≥–æ–¥–æ–≤—ã–µ —Ö—Ä–æ–Ω–∏–∫–∏; `DeepHistoryAI` ‚Äî –ø–∞–º—è—Ç—å —ç–ø–æ—Ö.  
- `ZeitgeistAI` ‚Äî –¥—É—Ö –≤—Ä–µ–º–µ–Ω–∏ (–æ–ø—Ç–∏–º–∏–∑–º‚Üî—É–ø–∞–¥–æ–∫) –∏–∑–º–µ–Ω—è–µ—Ç —á–∞—Å—Ç–æ—Ç—ã –≤–æ–π–Ω/–æ—Ç–∫—Ä—ã—Ç–∏–π/–∫—É–ª—å—Ç—É—Ä—ã.

## üßØ Guardrails (—ç—Ç–∏–∫–∞)
- –ë–µ–∑ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ–ø–∏—Å–∞–Ω–∏–π –Ω–∞—Å–∏–ª–∏—è/—Å–µ–∫—Å–∞. –û–ø–∏—Å—ã–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏.  
- –í—Å–µ –ø—Ä–æ–º–ø—Ç—ã LLM –ø–∞—Ä–∞–Ω–æ–∏–¥–∞–ª—å–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç **–∫–æ–º–ø–∞–∫—Ç–Ω—ã–π JSON**.  
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ PR ‚Äî –Ω–∞ —Ä—É—Å—Å–∫–æ–º.

## ‚úÖ –¶–µ–ª–∏ MVP
- –¢–∞–π–º-—Ü–∏–∫–ª, —Å–µ–∑–æ–Ω—ã, –ø–æ–≥–æ–¥–∞, —ç–∫–æ–Ω–æ–º–∏–∫–∞, –±–∞–∑–æ–≤—ã–µ NPC-—Ä–µ–ø–ª–∏–∫–∏.  
- –î–∏—Ñ—Ñ—É–∑–∏—è –∑–Ω–∞–Ω–∏–π, –ø–µ—Ä–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏/–æ—Ç–∫—Ä—ã—Ç–∏—è.  
- –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ—Å—Ç—ã–µ —Å—É–¥—ã.  
- –•—Ä–æ–Ω–∏–∫–∞ –≥–æ–¥–∞ –∏ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏.  
- –ù–∞–≤—ã–∫–∏ –∏ –∏—Ö —Ä–æ—Å—Ç –Ω–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
